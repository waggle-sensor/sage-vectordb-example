[supervisord]
nodaemon=true
user=root
logfile=/var/log/supervisor/supervisord.log
pidfile=/var/run/supervisord.pid

[program:redis]
command=redis-server --daemonize no --appendonly yes --dir /var/lib/redis
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/redis.err.log
stdout_logfile=/var/log/supervisor/redis.out.log
user=redis

[program:celery-worker]
command=python main.py
directory=/app
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/celery.err.log
stdout_logfile=/var/log/supervisor/celery.out.log
user=root

[program:celery-monitor]
command=python main.py monitor
directory=/app
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/monitor.err.log
stdout_logfile=/var/log/supervisor/monitor.out.log
user=root

[program:celery-cleanup]
command=celery -A job_system.tasks beat --loglevel=info
directory=/app
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/cleanup.err.log
stdout_logfile=/var/log/supervisor/cleanup.out.log
user=root

[program:metrics-server]
command=python -m metrics.server
directory=/app
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/metrics.err.log
stdout_logfile=/var/log/supervisor/metrics.out.log
user=root
